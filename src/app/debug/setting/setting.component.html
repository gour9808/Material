<div class="button-row" style="margin: 10px;">
  <mat-form-field>
    <mat-select placeholder="NEW TRACE CONFIG" (selectionChange)="checkValue($event)">
      <mat-option *ngFor="let config of configs" [value]="config.value">
        {{config.viewValue}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <button mat-raised-button (click)="fetchTraceLogs()" style="margin-left: 10px;">Refresh </button>

  <button mat-raised-button style="margin-left: 10px;">Manage Debug Levels</button>


</div>

<div class="mat-elevation-z8">
  <table mat-table [dataSource]="dataSource">

    <ng-container matColumnDef="Action">
      <th mat-header-cell *matHeaderCellDef> Action </th>
      <td mat-cell *matCellDef="let element">
        <div class="icon">
          <mat-icon (click)="confirm(element)">delete</mat-icon>
          <mat-icon *ngIf="element.LogType === 'DEVELOPER_LOG' || element.LogType === 'USER_DEBUG'">tab</mat-icon>
        </div>

      </td>
    </ng-container>

    <ng-container matColumnDef="User">
      <th mat-header-cell *matHeaderCellDef> User/Apex </th>
      <td mat-cell *matCellDef="let element"> {{element.TracedEntity.Name}} </td>
    </ng-container>

    <ng-container matColumnDef="expiration">
      <th mat-header-cell *matHeaderCellDef> Expiration Date </th>
      <td mat-cell *matCellDef="let element">{{element.ExpirationDate | timeAgo}}</td>
    </ng-container>


    <ng-container matColumnDef="debug">
      <th mat-header-cell *matHeaderCellDef> Debug Level </th>
      <td mat-cell *matCellDef="let element"> {{element.DebugLevel.DeveloperName}} </td>
    </ng-container>


    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

</div>

<p-confirmDialog></p-confirmDialog>


<p-dialog header="Add Trigger" [(visible)]="showTriggerDialog" [modal]="true" [responsive]="true" [width]="395">

  <p-autoComplete [suggestions]="filterUserForTrigger$" [emptyMessage]="emptyMessage" (completeMethod)="filterUserDataForTrigger($event)"
    placeholder="User" [minLength]="1" field="Name" (onSelect)="setUserIdForUser($event)"></p-autoComplete>
  <p-autoComplete [suggestions]="filterDebugLevel$" [style]="{'margin-left':'20px'}" [emptyMessage]="emptyMessage" (completeMethod)="filterDebugLevel($event)"
    field="DeveloperName" placeholder="Debug Level" [minLength]="1" (onSelect)="setDebugLevelId($event)"></p-autoComplete>

  <p-footer>
    <button pButton type="button" [disabled]="!goForIgnition()" (click)="createTrigger()" label="Create"></button>
    <button type="button" pButton icon="pi pi-close" (click)="showTriggerDialog=false" label="Cancel" class="ui-button-secondary"></button>

  </p-footer>
</p-dialog>


<p-dialog header="Add User" [(visible)]="showUserDialog" [modal]="true" [responsive]="true" [width]="395">

  <p-autoComplete [suggestions]="filtereUserForUser$" [emptyMessage]="emptyMessage" (completeMethod)="filterUserDataForUser($event)"
    placeholder="User" [minLength]="1" field="Name" showClear="true" (onSelect)="setUserIdForUser($event)"></p-autoComplete>
  <p-autoComplete [suggestions]="filterDebugLevel$" [style]="{'margin-left':'20px'}" [emptyMessage]="emptyMessage" (completeMethod)="filterDebugLevel($event)"
    field="DeveloperName" placeholder="Debug Level" [minLength]="1" (onSelect)="setDebugLevelId($event)"></p-autoComplete>
  <p-footer>
    <button pButton type="button" (click)="createUser()" [disabled]="!goForIgnition()" label="Create"></button>
    <button type="button" pButton icon="pi pi-close" (click)="showUserDialog=false" label="Cancel" class="ui-button-secondary"></button>
  </p-footer>
</p-dialog>


<p-dialog header="Add Class" [(visible)]="showClassDialog" [modal]="true" [responsive]="true" [width]="395">
  <p-autoComplete [suggestions]="filterUserForClass$" [emptyMessage]="emptyMessage" (completeMethod)="filterUserDataForClass($event)"
    placeholder="User" [minLength]="1" field="Name" (onSelect)="setUserIdForUser($event)"></p-autoComplete>
  <p-autoComplete [suggestions]="filterDebugLevel$" [style]="{'margin-left':'20px'}" [emptyMessage]="emptyMessage" (completeMethod)="filterDebugLevel($event)"
    field="DeveloperName" placeholder="Debug Level" [minLength]="1" (onSelect)="setDebugLevelId($event)"></p-autoComplete>

  <p-footer>
    <button type="button" pButton icon="pi pi-check" (click)="createClass()" [disabled]="!goForIgnition()" label="Create"></button>
    <button type="button" pButton icon="pi pi-close" label="No" class="ui-button-secondary"></button>
  </p-footer>
</p-dialog>